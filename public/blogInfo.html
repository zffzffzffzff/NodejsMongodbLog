<!DOCTYPE html>
<html>
<head>
	<title>539博客</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
	<script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>

<body style="background-color: #F0F0F0">

	<div class="container">
		<!-- 导航条 -->
		<nav class="navbar navbar-expand-lg navbar-dark shadow" style="background-color: #171717;">
			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#navbarTogglerDemo03"
				aria-controls="navbarTogglerDemo03" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<a class="navbar-brand" href="index.html">539博客</a>
			
			<img alt="comment" src="photo/pen.png" width=22px height=22px style="margin-left:30px; margin-right:0px">
				
			<div class="collapse navbar-collapse">
				<ul class="navbar-nav mr-sm-0 mt-2 mt-lg-0">
				<li class="nav-item">
					<a class="nav-link" href="write.html" style="color:#E0E0E0" onmouseover="this.style.color='#FFFFFF'" onmouseout="this.style.color='#E0E0E0'">
					创作中心
					</a>
				</li>
				<li class="nav-item" style="margin-left:20px">
					<a class="nav-link disabled" href="#">
					19计算机2班 190110910539 朱芳菲
					</a>
				</li>
				</ul>
				
				<form class="form-inline ml-auto my-2 my-lg-0" action="Query" style="width:300px; margin-right:10px">
				<input class="form-control mr-sm-2 col-sm-7 ml-auto " type="search" name="search"
					placeholder="请输入关键词" value="${key}" aria-label="Search" >
				<button class="btn btn-outline-light my-2 my-sm-0" type="submit">搜索</button>
				</form>
				
				<img alt="comment" src="photo/head.png" width=25px height=25px style="margin-left:30px; margin-right:0px">
				
				<ul class="navbar-nav ml-sm-2 ml-auto col-sm-1">
					<li class="nav-item dropdown">
						<a id="Uname" class="nav-link dropdown-toggle active" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></a>

						<!-- 下拉列表 -->
						<div id="Dropdown" class="dropdown-menu" style="min-width:120%" aria-labelledby="navbarDropdown">
						</div>
						 
						<script>
							function loginCheck() {
								var xhttp = new XMLHttpRequest();
								xhttp.onreadystatechange = function() {
									if (this.readyState == 4 && this.status == 200) {
										document.getElementById("Uname").innerHTML =
										this.responseText;
									}
									else document.getElementById("Uname").innerHTML =
										"无响应";
								};
								xhttp.open("GET", "/loginCheck", true);
								xhttp.send();
							}
							loginCheck();
						</script>

						<script>
							function dropdown() {
								var xhttp = new XMLHttpRequest();
								xhttp.onreadystatechange = function() {
									if (this.readyState == 4 && this.status == 200) {
										document.getElementById("Dropdown").innerHTML =
										this.responseText;
									}
									else document.getElementById("Dropdown").innerHTML =
										"无响应";
								};
								xhttp.open("GET", "/dropdown", true);
								xhttp.send();
							}
							dropdown();
						</script>

						<script>
							function logout() {
								var xhttp = new XMLHttpRequest();
								xhttp.open("GET", "/logout", true);
								xhttp.send();
								loginCheck();
								dropdown();
							}
						</script>
						
					</li>
				</ul>
				
			</div>
		</nav>

		<!-- 内容 -->
		<div class="row" style="margin-top: 15px">

			<div class="col-9">

				<div class="card shadow" style="margin-bottom: 10px">
					<div class="card-header" style="font-weight: bold">博客详情</div>
					<div class="card-body" style="height:320px">

						<div class="float-right"
							style="width: 80px; margin-right: 10px; margin-top: 10px;">
							<h6
								style="width: 40px; margin-top: 2px; margin-left: 10px; float: right">${blog.pageview}</h6>
							<img alt="read" src="photo/read.png" width="25px"
								style="float: right">
						</div>
						<h2 class="card-title text-center" style="margin-left: 90px">${blog.title}</h2>

						<p class="card-text"
							style="font-size: 18px; margin: 20px; margin-top: 25px; height:100px">
							${blog.body}</p>
						<div class="float-right" style="width: 400px; margin-top: 50px">
							<div class="float-right" align="center" style="width: 60px;">
								<a style="text-decoration: none; color: #000000;">
									<img alt="comment" src="photo/comment.png" width="40%"
									style="margin-bottom: 0px">
								</a>
								<h6>${blog.comment}</h6>
							</div>
							<div class="float-right" align="center" style="width: 60px;">
								
								<a href="LikeAction?blogId=${blog.id}" style="text-decoration: none; color: #000000;">
									<img alt="like" src="photo/${like}.png" width="42%"
									style="margin-bottom: 0px">
								</a>
								<h6>${blog.like}</h6>
							</div>
						</div>
					</div>
					<div class="card-footer text-muted text-center">发布时间：${blog.timeCn}</div>
				</div>
				
				<div class="card shadow" style="margin-bottom: 20px">
				
					<div class="card-body" style="margin:10px; margin-top:0px; margin-bottom:-20px">
					
						<!-- 显示提示信息 -->
						<p style="color:red; margin:5px">${info}</p>
						
						<form action="CommentAction?blogId=${blog.id}" method="post" style="margin-bottom:25px;">
							<button type="submit" class="btn btn-dark" style="float:right; margin:auto; width:15%">评论</button>
							<input type="text" class="form-control" name="comment" style="width:82%"
										placeholder="请写下您的评论" required>
						</form>
						
						<table class="table">
							<tbody>
							<c:forEach items="${comment}" var="comment">
								<tr>
									<td>
										<a href="UserInfo?username=${comment.username}&&flag=hot" style="width:12%; color:#272727; margin-left:10px">
										 	${comment.username}
										</a>
										:
										<div style="width:88%; float:right; padding-right:10px">${comment.comment}</div>
									</td>
								</tr>
							</c:forEach>
							</tbody>
						</table>
						
					</div>
				</div>
				

			</div>

			<!-- 右边栏 -->
			<div class="col-lg-3 ">
				<div class="card shadow" style="margin-bottom: 10px">

  					<div class="card-header" align="center" style="font-weight:bold">博主信息</div>
					<div class="card-body" style="padding: 0px">
					
						<div style="padding:20px">
							<img src="photo/${user.photo_name}.jpg" width=60px height=60px style="border-radius:50%; margin-top:7px; margin-left:6px; margin-bottom:6px">
							<div class="float-right" style="width:120px">
								<a href="UserInfo?username=${blog.author}&&flag=hot" style="text-decoration:none; font-weight:bold; font-size:25px; color:#272727" onmouseover="this.style.color='#3C3C3C'" onmouseout="this.style.color='#272727'">
									${blog.author}
								</a>
								<img alt="sex" src="photo/${user.sex}.png" width=23px style="margin-bottom:10px">
								<p>访问量：${pageview.sum}</p>
							</div>
						</div>
						
					</div>
				</div>
					
				<div class="card shadow" style="margin-bottom: 20px">
					<div class="card-body" style="padding: 0px; margin-top:10px">
					
						<p style="padding-left:25px; margin-bottom:10px; font-weight:bold">热门博客</p>
						<form action="RankAction" style="margin-bottom:-15px">
							<table class="table table-hover">
								<tbody>
									<c:forEach items="${hotBlog}" var="blog">
									<tr align="center">
										<td width="65%" align="left" style="padding-left:25px">
											<a href="BlogInfo?blogId=${blog.id}" style="color: #272727">${blog.title}</a>
										</td>
										<td width="30%" align="left">
											<img alt="read" src="photo/read.png" width="20px">
											${blog.pageview}
										</td>
									</tr>
									</c:forEach>
								</tbody>
							</table>
						</form>
										
					</div>
					
				</div>
			</div>

		</div>
	</div>

</body>
</html>